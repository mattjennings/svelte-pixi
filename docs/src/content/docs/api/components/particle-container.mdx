---
title: ParticleContainer
---

import SvelteTabs from '$lib/components/SvelteTabs.astro'
import ComponentAPI from '$lib/components/ComponentAPI.astro'
import ComponentDescription from '$lib/components/svelte-5/ComponentDescription.astro'

Renders a PIXI.ParticleContainer.

<ComponentDescription name="ParticleContainer" source="https://pixijs.download/dev/docs/scene.ParticleContainer.html" />

## Usage

Note: when working with thousands of components, it is **much** more performant to create & update the Pixi instances directly instead of through components

<SvelteTabs>
  <div slot="svelte-5">
    ```svelte live props={{ assets: ["/assets/star.png"] }}
    <script>
      import * as PIXI from 'pixi.js'
      import { Sprite, onTick, ParticleContainer } from 'svelte-pixi'      

      const width = 720
      const height = 400
      const speed = 0.025
      const fov = 20
      const starSize = 0.05

      let container = $state()
      let cameraZ = 0
      let amount = $state(5000)

      let stars = $derived(
        new Array(amount).fill(null).map(() => {
          const star = new PIXI.Particle(PIXI.Texture.from('/assets/star.png'))

          const deg = Math.random() * Math.PI * 2
          const distance = Math.random() * 50 + 1

          star.initX = Math.cos(deg) * distance
          star.initY = Math.sin(deg) * distance
          star.initZ = Math.random() * 1000 + 750

          star.x = star.initX
          star.y = star.initY
          star.z = star.initZ

          updateStar(star)

          return star
        })
      )

      // add/remove stars
      $effect(() => {
        if (container) {
          for (const star of stars) {
            container.addParticle(star)
          }

          // preserve the stars array for cleanup
          let _stars = stars
          return () => {
            for (const star of _stars) {
              container.removeParticle(star)
            }
          }
        }
      })

      function updateStar(star) {
        const z = star.z - cameraZ
        const distance = Math.max(0, (2000 - z) / 2000)

        star.scaleX = distance * starSize
        star.scaleY = distance * starSize
        star.anchorX = 0.5
        star.anchorY = 0.7

        star.x = star.initX * (fov / z) * width + width / 2
        star.y = star.initY * (fov / z) * height + height / 2
      }

      // move the camera forward
      onTick((ticker) => {
        cameraZ += ticker.deltaTime * 10 * speed

        for (const star of stars) {
          if (!star.destroyed) {
            updateStar(star)
          }
        }
      })
    </script>

    <label class="flex flex-col !mt-0">
      <span class="text-white text-center">Amount: {amount}</span>
      <input type="range" min="0" max="10000" step="100" bind:value={amount} />
    </label>

    <ParticleContainer bind:instance={container} />
    ```
  </div>
  <div slot="svelte-4">    
    ```svelte live props={{ assets: ["/assets/star.png"] }}
    <script>
      import * as PIXI from 'pixi.js'
      import { Sprite, onTick, ParticleContainer } from 'svelte-pixi/svelte-4'
      import { onMount } from 'svelte'

      const width = 720
      const height = 400
      const speed = 0.025
      const fov = 20
      const starSize = 0.05

      let container
      let cameraZ = 0
      let amount = 1000
      let stars = []

      // create stars for amount value
      $: {
        // cleanup previous stars
        stars.forEach((star) => container.removeParticle(star))

        // create stars
        if (container) {
          stars = new Array(amount).fill(null).map(() => {
            const star = new PIXI.Particle(PIXI.Texture.from('/assets/star.png'))
            const deg = Math.random() * Math.PI * 2
            const distance = Math.random() * 50 + 1

            star.initX = Math.cos(deg) * distance
            star.initY = Math.sin(deg) * distance
            star.initZ = Math.random() * 1000 + 750

            star.x = star.initX
            star.y = star.initY
            star.z = star.initZ

            updateStar(star)

            return star
          })

          if (stars.length) {
            container.addParticle(...stars)        
          }
        }
      }

      function updateStar(star) {
        const z = star.z - cameraZ
        const distance = Math.max(0, (2000 - z) / 2000)

        star.scaleX = distance * starSize
        star.scaleY = distance * starSize
        star.anchorX = 0.5
        star.anchorY = 0.7

        star.x = star.initX * (fov / z) * width + width / 2
        star.y = star.initY * (fov / z) * height + height / 2
      }

      // move the camera forward
      onTick((ticker) => {
        cameraZ += ticker.deltaTime * 10 * speed

        for (const star of stars) {
          updateStar(star)
        }
      })

      onMount(() => {
        // make sure to remove stars on unmount
        return () => {
          stars.forEach((star) => container.removeParticle(star))
        }
      })
    </script>

    <label class="flex flex-col !mt-0">
      <span class="text-white text-center">Amount: {amount}</span>
      <input type="range" min="0" max="10000" step="100" bind:value={amount} />
    </label>

    <ParticleContainer bind:instance={container} />
    ```
  </div>
</SvelteTabs>


## API

<ComponentAPI component="ParticleContainer.svelte" />
